<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تسجيل الدخول - منصة مساند</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="../css/styles.css" rel="stylesheet">
    <link href="../css/auth.css" rel="stylesheet">
</head>
<body>
    <header class="site-header" data-site-header data-base="../" data-nav-id="authNav" data-home="index.html" data-primary-text="إنشاء حساب" data-primary-href="register.html" data-secondary-text="العودة للرئيسية" data-secondary-href="../index.html" data-secondary-variant="outline"></header>

    <main>
    <section class="hero hero--light hero--compact auth-hero">
            <div class="container split">
                <div class="card card--glass layout-stack">
                    <span class="pill pill--neutral align-start">مرحباً مجدداً</span>
                    <h1 class="section__title section__title--lg">سجّل دخولك لمتابعة رحلتك التعليمية</h1>
                    <p class="text-muted">
                        تابع الدورات المفتوحة، استعرض تقدمك في المسارات، واستلم الإشعارات الجديدة فور حدوثها. حسابك في مساند يمنحك وصولاً موحداً لكل المحتوى بالعربية.
                    </p>
                    <ul class="layout-stack layout-stack--sm text-body">
                        <li>✔ لوحة تحكم تبرز أنشطتك الأخيرة والدروس القادمة.</li>
                        <li>✔ مزامنة تلقائية لحالتك بين الويب والتطبيق التقدمي PWA.</li>
                        <li>✔ دعم فني سريع وخيارات تذكير بالمهام غير المكتملة.</li>
                    </ul>
                    <div class="stat-card">
                        <div class="stat-card__value">+500</div>
                        <div class="stat-card__label">جلسة تسجيل دخول أسبوعياً على المنصة</div>
                    </div>
                </div>

                        <div class="card form layout-stack auth-card" aria-labelledby="loginTitle">
                    <h2 id="loginTitle" class="section__title section__title--md mb-0 form-title">تسجيل الدخول</h2>
                    <p class="text-body form-subtitle">أدخل بياناتك للمتابعة. جميع الاتصالات مشفّرة بالكامل.</p>
                    <form id="loginForm" class="layout-stack" action="/auth/login" method="POST" novalidate>
                        <div>
                            <label for="userOrEmail" class="form-label">اسم المستخدم أو البريد الإلكتروني</label>
                            <input id="userOrEmail" name="userOrEmail" type="text" class="input-field" placeholder="example@musanid.com" autocomplete="username" required>
                        </div>

                        <div>
                            <div class="layout-inline layout-inline--between layout-inline--center">
                                <label for="password" class="form-label mb-0">كلمة المرور</label>
                        		<a class="link-accent text-sm" href="#">نسيت كلمة المرور؟</a>
                            </div>
                            <input id="password" name="password" type="password" class="input-field" placeholder="••••••••" autocomplete="current-password" required>
                            <p class="form-helper text-sm">استخدم ٨ أحرف على الأقل مع مزيج من الرموز والأرقام.</p>
                        </div>

                        <label class="checkbox-field">
                            <input id="remember" name="remember" type="checkbox">
                            <span>تذكرني مجدداً</span>
                        </label>

                        <button type="submit" class="btn btn-primary btn--block">تسجيل الدخول</button>
                        <p class="form-helper text-center">
                            لا تملك حساباً بعد؟
                            <a class="link-accent" href="register.html">أنشئ حساباً جديداً</a>
                        </p>
                        <div class="form-helper is-hidden" id="loginMessage" role="alert"></div>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <footer class="site-footer" data-site-footer data-base="../"></footer>

    <script src="../js/components/header.js"></script>
    <script src="../js/components/footer.js"></script>
    <script src="../js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const res = await fetch('/csrf-token', { credentials: 'include' });
                if (!res.ok) {
                    return;
                }

                const data = await res.json();
                if (!data?.csrfToken) {
                    return;
                }

                const form = document.getElementById('loginForm');
                if (!form) {
                    return;
                }

                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = '_csrf';
                input.value = data.csrfToken;
                form.prepend(input);
            } catch (error) {
                const helper = document.getElementById('loginMessage');
                if (helper) {
                    helper.textContent = 'تعذّر الاتصال بالخادم. سيُعاد المحاولة عند التحديث.';
                    helper.classList.remove('is-hidden');
                    helper.classList.add('is-error');
                }
            }
        });
    </script>
</body>
</html>