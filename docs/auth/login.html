<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>๐ ุชุณุฌูู ุงูุฏุฎูู - ููุตุฉ ูุณุงูุฏ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="../css/styles.css" rel="stylesheet">
    <link href="../css/auth.css" rel="stylesheet">
</head>
<body>
    <header class="site-header" 
            data-site-header 
            data-base="../" 
            data-active="login"
            data-primary-text="ุฅูุดุงุก ุญุณุงุจ"
            data-primary-href="register.html"
            data-secondary-text="ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ"
            data-secondary-href="../index.html"
            data-secondary-variant="outline"></header>

    <main>
    <section class="hero hero--light hero--compact auth-hero">
            <div class="container split">
                <div class="card card--glass layout-stack">
                    <span class="pill pill--neutral align-start">ูุฑุญุจุงู ูุฌุฏุฏุงู</span>
                    <h1 class="section__title section__title--lg">ุณุฌูู ุฏุฎููู ููุชุงุจุนุฉ ุฑุญูุชู ุงูุชุนููููุฉ</h1>
                    <p class="text-muted">
                        ุชุงุจุน ุงูุฏูุฑุงุช ุงูููุชูุญุฉุ ุงุณุชุนุฑุถ ุชูุฏูู ูู ุงููุณุงุฑุงุชุ ูุงุณุชูู ุงูุฅุดุนุงุฑุงุช ุงูุฌุฏูุฏุฉ ููุฑ ุญุฏูุซูุง. ุญุณุงุจู ูู ูุณุงูุฏ ูููุญู ูุตููุงู ููุญุฏุงู ููู ุงููุญุชูู ุจุงูุนุฑุจูุฉ.
                    </p>
                    <ul class="layout-stack layout-stack--sm text-body">
                        <li>โ ููุญุฉ ุชุญูู ุชุจุฑุฒ ุฃูุดุทุชู ุงูุฃุฎูุฑุฉ ูุงูุฏุฑูุณ ุงููุงุฏูุฉ.</li>
                        <li>โ ูุฒุงููุฉ ุชููุงุฆูุฉ ูุญุงูุชู ุจูู ุงูููุจ ูุงูุชุทุจูู ุงูุชูุฏูู PWA.</li>
                        <li>โ ุฏุนู ููู ุณุฑูุน ูุฎูุงุฑุงุช ุชุฐููุฑ ุจุงูููุงู ุบูุฑ ุงูููุชููุฉ.</li>
                    </ul>
                    <div class="stat-card">
                        <div class="stat-card__value">+500</div>
                        <div class="stat-card__label">ุฌูุณุฉ ุชุณุฌูู ุฏุฎูู ุฃุณุจูุนูุงู ุนูู ุงูููุตุฉ</div>
                    </div>
                </div>

                        <div class="card form layout-stack auth-card" aria-labelledby="loginTitle">
                    <h2 id="loginTitle" class="section__title section__title--md mb-0 form-title">ุชุณุฌูู ุงูุฏุฎูู</h2>
                    <p class="text-body form-subtitle">ุฃุฏุฎู ุจูุงูุงุชู ูููุชุงุจุนุฉ. ุฌููุน ุงูุงุชุตุงูุงุช ูุดููุฑุฉ ุจุงููุงูู.</p>
                    <form id="loginForm" class="layout-stack" action="/auth/login" method="POST" novalidate>
                        <div class="form__row">
                            <div>
                                <label for="userOrEmail" class="form-label">ุงุณู ุงููุณุชุฎุฏู ุฃู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                                <input id="userOrEmail" name="userOrEmail" type="text" class="input-field" placeholder="example@musanid.com" autocomplete="username" required>
                            </div>

                            <div>
                                <label for="password" class="form-label">ูููุฉ ุงููุฑูุฑ</label>
                                <div class="input-group">
                                    <input id="password" name="password" type="password" class="input-field" placeholder="โขโขโขโขโขโขโขโข" autocomplete="current-password" required>
                                    <button type="button" id="togglePassword" class="input-group__btn" aria-label="ุฅุธูุงุฑ ูููุฉ ุงููุฑูุฑ" title="ุฅุธูุงุฑ ูููุฉ ุงููุฑูุฑ">
                                        <svg id="eyeIcon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                            <circle cx="12" cy="12" r="3"></circle>
                                        </svg>
                                        <svg id="eyeOffIcon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19M1 1l22 22M6.71 6.71l10.58 10.58"></path>
                                        </svg>
                                    </button>
                                </div>
                                <p class="form-helper text-sm">ุงุณุชุฎุฏู ูจ ุฃุญุฑู ุนูู ุงูุฃูู ูุน ูุฒูุฌ ูู ุงูุฑููุฒ ูุงูุฃุฑูุงู.</p>
                                <a class="link-accent text-sm" href="#">ูุณูุช ูููุฉ ุงููุฑูุฑุ</a>
                            </div>
                        </div>

                        <label class="checkbox-field">
                            <input id="remember" name="remember" type="checkbox">
                            <span>ุชุฐูุฑูู ูุฌุฏุฏุงู</span>
                        </label>

                        <button type="submit" class="btn btn-primary btn--block">ุชุณุฌูู ุงูุฏุฎูู</button>
                        <p class="form-helper text-center">
                            ูุง ุชููู ุญุณุงุจุงู ุจุนุฏุ
                            <a class="link-accent" href="register.html">ุฃูุดุฆ ุญุณุงุจุงู ุฌุฏูุฏุงู</a>
                        </p>
                        <div class="form-helper is-hidden" id="loginMessage" role="alert"></div>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <footer class="site-footer" 
            data-site-footer 
            data-base="../"></footer>

    <!-- Load Reusability System Scripts -->
    <script defer src="../js/config.js"></script>
    <script defer src="../js/components/header.js"></script>
    <script defer src="../js/components/footer.js"></script>
    <script defer src="../js/main.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const toggleBtn = document.getElementById('togglePassword');
            const passwordInput = document.getElementById('password');
            const eyeIcon = document.getElementById('eyeIcon');
            const eyeOffIcon = document.getElementById('eyeOffIcon');

            if (toggleBtn && passwordInput && eyeIcon && eyeOffIcon) {
                toggleBtn.addEventListener('click', () => {
                    const isPassword = passwordInput.type === 'password';
                    
                    // ุชุจุฏูู ููุน ุงูุญูู
                    passwordInput.type = isPassword ? 'text' : 'password';
                    
                    // ุชุจุฏูู ุงูุฃููููุงุช
                    if (isPassword) {
                        eyeIcon.style.display = 'none';
                        eyeOffIcon.style.display = 'block';
                        toggleBtn.setAttribute('aria-label', 'ุฅุฎูุงุก ูููุฉ ุงููุฑูุฑ');
                        toggleBtn.setAttribute('title', 'ุฅุฎูุงุก ูููุฉ ุงููุฑูุฑ');
                    } else {
                        eyeIcon.style.display = 'block';
                        eyeOffIcon.style.display = 'none';
                        toggleBtn.setAttribute('aria-label', 'ุฅุธูุงุฑ ูููุฉ ุงููุฑูุฑ');
                        toggleBtn.setAttribute('title', 'ุฅุธูุงุฑ ูููุฉ ุงููุฑูุฑ');
                    }
                });
            }
        });

        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const res = await fetch('/csrf-token', { credentials: 'include' });
                if (!res.ok) {
                    return;
                }

                const data = await res.json();
                if (!data?.csrfToken) {
                    return;
                }

                const form = document.getElementById('loginForm');
                if (!form) {
                    return;
                }

                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = '_csrf';
                input.value = data.csrfToken;
                form.prepend(input);
            } catch (error) {
                const helper = document.getElementById('loginMessage');
                if (helper) {
                    helper.textContent = 'ุชุนุฐูุฑ ุงูุงุชุตุงู ุจุงูุฎุงุฏู. ุณููุนุงุฏ ุงููุญุงููุฉ ุนูุฏ ุงูุชุญุฏูุซ.';
                    helper.classList.remove('is-hidden');
                    helper.classList.add('is-error');
                }
            }
        });
    </script>
</body>
</html>